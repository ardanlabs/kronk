edition = "2024";

package auth;

option go_package = "github.com/ardanlabs/kronk/app/domain/grpcauthapp";

// The authentication service definition.
service Auth {
  // Generate a token for a given key ID.
  rpc CreateToken(CreateTokenRequest) returns (CreateTokenResponse);

  // Authenticate a request using a bearer token.
  rpc Authenticate(AuthenticateRequest) returns (AuthenticateResponse);
}

// Request message for generating a token.
message CreateTokenRequest {
  string token = 1;
  string user_name = 2;
  bool admin = 3;
  string duration = 4;
  repeated string endpoints = 5;
}

// Response message for token generation.
message CreateTokenResponse {
  string token = 1;
}

// Request message for authentication.
message AuthenticateRequest {
  string token = 1;
  bool admin = 2;
  string endpoint = 3;
}

// Response message for authentication.
message AuthenticateResponse {
  string token_id = 1;
  string subject = 2;
}
